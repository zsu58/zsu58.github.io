---
title: "[Apache Airflow] Airflow Installation on Docker"
layout: single
date: '29/12/2021'
toc: true
toc_sticky: true
toc_label: Table of Contents
categories:
  - AIRFLOW
tags:
  - AIRFLOW
  - DOCKER
---

---
### Airflow on Docker
* Airflow-Docker Installation
* Docker Airflow CLI

---

### Airflow-Docker Installation
```bash
# make folder and cd
mkdir airflow-docker
cd airflow-docker

# docker-compose.yaml file download(check version)
curl -LfO 'https://airflow.apache.org/docs/apache-airflow/2.1.4/docker-compose.yaml'

# make folders for dags & plugins & logs
mkdir ./dags ./plugins ./logs

# On Linux & Mac OS, the quick-start needs to know your host user id and needs to have group id set to 0
echo -e "AIRFLOW_UID=$(id -u)\nAIRFLOW_GID=0" > .env

# .env íŒŒì¼ * íŒŒì¼ ì•ˆì˜ ë‹¤ìŒê³¼ ê°™ì€ ë‚´ìš© ìƒê¹€
# AIRFLOW_UID=501
# AIRFLOW_GID=0

# run database migrations and create the first user account
docker-compose up airflow-init

# cf. airflow-dockerì€ requires at least 4GB memory
# ì˜ ì„¤ì¹˜ëœ ê²½ìš° ì•„ë˜ì™€ ê°™ì€ msg ë‚˜ì˜´ 
# airflow-init_1       | 2.1.4
# airflow-docker_airflow-init_1 exited with code 0

# run airflow
docker-compose up

# end airflow
docker-compose down
```
---



### Docker Airflow CLI

#### ë°©ë²•1
```bash
curl -LfO 'https://airflow.apache.org/docs/apache-airflow/2.1.4/airflow.sh'
chmod +x airflow.sh

# ì»¨í…Œì´ë„ˆ bash í™˜ê²½ìœ¼ë¡œ ì ‘ì†
./airflow.sh bash
```

#### ë°©ë²•2
```bash
docker container exec -it airflow_airflow-worker_1 bash
```

#### ë°©ë²•3
```bash
# create user
docker-compose run airflow-worker users create -u zsu -p abcd -f jisu -l park -r Admin -e zsu58@icloud.com

# airflow ëª…ë ¹ì–´ ì‚¬ìš©í•˜ê¸° ìœ„í•œ venv êµ¬ì„±
# airflow ì„¤ì¹˜í•œ í´ë”ë¡œ cd
python3 -m venv airflow1
source airflow1/bin/activate

# install airflow
pip3 install apache-airflow==2.1.4
```


### ref 
* [ğŸ”— ê³µì‹ ë¬¸ì„œ](https://airflow.apache.org/docs/apache-airflow/2.1.4/start/docker.html)
* [ğŸ”— ì°¸ê³  ë¸”ë¡œê·¸](https://jybaek.tistory.com/922)
* [ğŸ”— ê°€ìƒí™˜ê²½ ê´€ë ¨](https://devbull.xyz/python-create-environment/)