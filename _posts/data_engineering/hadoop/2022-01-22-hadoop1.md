---
title: "[Hadoop] Hadoop Installation  on Local(Mac)"
layout: single
date: '22/01/2022'
toc: true
toc_sticky: true
toc_label: Table of Contents
categories:
  - HADOOP
tags:
  - HADOOP
---

---
### Hadoop Installation on Local(Mac)
* Hadoop Installation
* í™˜ê²½ë³€ìˆ˜ ì„¤ì •
* ì‚¬ì „ ì¤€ë¹„
* Hadoop ì‹¤í–‰
* MapReduce ì‹¤í–‰
* Yarn í™•ì¸
* Error ê´€ë ¨

---


### Hadoop Installation
* ì„¤ì¹˜í™˜ê²½
    * OS: macOS Big Sur 11.6
    * Hadoop: 3.3.1

```bash
brew install hadoop

# hadoopì€ openjdkì— dependencyê°€ ì¡´ì¬í•˜ê¸°ì— hadoop ì„¤ì¹˜ì‹œ ìë™ìœ¼ë¡œ ì„¤ì¹˜ë¨
# ë§Œì•½ ê¸°ì¡´ì— ì‚¬ìš©í•˜ë˜ openjdkê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš° ì œê±° ê°€ëŠ¥
```
---

### í™˜ê²½ë³€ìˆ˜ ì„¤ì •
* directory: /usr/local/Cellar/hadoop/3.3.1/libexec/etc/hadoop

```bash
# hadoop-env.sh (ë§¨ ì•„ë˜ì— ì¶”ê°€)
export HADOOP_OPTS="$HADOOP_OPTS -Djava.net.preferIPv4Stack=true -Djava.security.krb5.realm= -Djava.security.krb5.kdc="
export JAVA_HOME="/Library/Java/JavaVirtualMachines/jdk1.8.0_202.jdk/Contents/Home"

# core-site.xml
<configuration>
    <property>
        <name>hadoop.tmp.dir</name>
        <value>/usr/local/Cellar/hadoop/hdfs/tmp</value>
        <description>A base for other temporary directories.</description>
    </property>
    <property>
        <name>fs.default.name</name>
        <value>hdfs://localhost:9000</value>
    </property>
</configuration>

# hdfs-site.xml
<configuration>
  <property>
    <name>dfs.replication</name>
    <value>1</value>
  </property>
</configuration>

# mapred-site.xml
<configuration>
  <property>
    <name>mapreduce.framework.name</name>
    <value>yarn</value>
  </property>
  <property>
    <name>mapreduce.application.classpath</name>   
    <value>$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/*:$HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib/*</value>
  </property>
</configuration>

# yarn-site.xml
<configuration>
  <property>
    <name>yarn.nodemanager.aux-services</name>
    <value>mapreduce_shuffle</value>
  </property>
  <property>
    <name>yarn.nodemanager.env-whitelist</name>
    <value>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME</value>
  </property>
</configuration>
```
---

### ì‚¬ì „ ì¤€ë¹„
```bash
# ì•„ë˜ ëª…ë ¹ì–´ ì…ë ¥
ssh localhost
# ë§Œì•½ ì ‘ì†ì‹œê°„ì´ ì•ˆëœ¨ê³  Connection refused ë¼ê³  ëœ¨ë©´, ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥
ssh-keygen -t rsa -P '' -f ~/.ssh/id_rsa
cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys
chmod 0600 ~/.ssh/authorized_keys

# ë””ë ‰í† ë¦¬ ë³€ê²½
cd /usr/local/Cellar/hadoop/3.3.1/libexec/bin

# HDFS í¬ë§·
hdfs namenode -format
# í¬ë§·ì‹œ, /usr/local/Cellar/hadoopì— hdfs ìƒì„±ë¨

# alias ë“±ë¡
alias hstart="/usr/local/Cellar/hadoop/3.3.1/libexec/sbin/start-all.sh"
alias hstop="/usr/local/Cellar/hadoop/3.3.1/libexec/sbin/stop-all.sh"
```
---

### Hadoop ì‹¤í–‰
* Cluster status : http://localhost:8088
* HDFS status : http://localhost:9870 
* Secondary NameNode status : http://localhost:9868

```bash
# í•˜ë‘¡ ì‹œì‘
hstart
# ë§Œì•½ "localhost: ssh: connect to host localhost port 22: Connection refused" ë°œìƒì‹œ
# System Preferences - Sharing - Remote Login ì ‘ì†í›„
# 1) Remote Loginì„ onìœ¼ë¡œ ìˆ˜ì •
# 2) Allow full disk access for remote users í´ë¦­

# í™•ì¸
jps 
# NodeManager, NameNode, Jps, DataNode, ResourceManager, SecondaryNameNodeê°€ ì •ìƒì ìœ¼ë¡œ ë‚˜ì˜¤ëŠ”ì§€ í™•ì¸

# ì¢…ë£Œ
hstop
```
---

### MapReduce ì‹¤í–‰
* localì— wFile01.txt, wFile02.txt ì¤€ë¹„ í›„ í•´ë‹¹ ë””ë ‰í† ë¦¬ì—ì„œ ì§„í–‰

```bash
#-------- 
# íŒŒì¼ ì£¼ì…
#--------

# ë””ë ‰í† ë¦¬ ìƒì„±
hadoop fs -mkdir /input01

# ë””ë ‰í† ë¦¬ í™•ì¸
hadoop fs -ls /

# íŒŒì¼ ì˜®ê¸°ê¸°
hadoop fs -put ./wFile01.txt /input01
hadoop fs -put ./wFile02.txt /input01

# í™•ì¸
hadoop fs -ls /input01
hadoop fs -cat /input01/wFile01.txt
hadoop fs -cat /input01/wFile02.txt

# jar íŒŒì¼ ì•ˆì˜ wordcount í´ë˜ìŠ¤ë¥¼ ì´ìš©í•´, input01 ì•ˆì˜ íŒŒì¼ì— mapreduceì— ì ìš© í›„, output01ë¡œ
hadoop jar /usr/local/Cellar/hadoop/3.3.1/libexec/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.3.1.jar wordcount /input01 /output01

# í™•ì¸
hadoop fs -cat /output01/
```
---

### Yarn í™•ì¸

```bash
yarn jar /opt/hadoop-3.2.3/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.3.jar pi 16 100000
```
---

### Error
* start-all.shë¡œ í•˜ë‘¡ ì‹¤í–‰ ì‹œ, secondarynodemanagerê³¼ ê´€ë ¨í•´ operation timed out ì—ëŸ¬ ë°œìƒ
* ì›ì¸: ì§‘ ê³µìœ ê¸°ê°€ SKì¸ë°, SKì—ì„œëŠ” 22ë²ˆ í¬íŠ¸ë¥¼ ë§‰ì•„ ë†“ì€ ê²½ìš°ê°€ ìˆë‹¤ê³  í•¨
* ì„ì‹œì ì¸ í•´ê²°: í•¸ë“œí° í•«ìŠ¤íŒŸìœ¼ë¡œ ì§„í–‰ ì‹œ ì •ìƒ ì‘ë™ í™•ì¸

---

### ref
* [ğŸ”— ê³µì‹ë¬¸ì„œ](https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html)
* [ğŸ”— ì°¸ê³ 1](https://key4920.github.io/p/mac-osì—-í•˜ë‘¡hadoop-ì„¤ì¹˜/)
* [ğŸ”— ì°¸ê³ 2](https://stackoverflow.com/questions/51808588/run-hadoop-in-the-mac-os)