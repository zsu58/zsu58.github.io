---
title: "[Error] Installing pyenv for X86 & ARM"
layout: single
date: '09/07/2022'
toc: true
toc_sticky: true
toc_label: Table of Contents
categories:
  - ERROR
tags:
  - AWS
  - REDSHIFT
  - AIRFLOW
---

---
### Installing pyenv for X86 & ARM
* ìƒí™© 
  * ì‚¬ë‚´ clue-api M1 pyenvë¡œ í™˜ê²½ì„¤ì • í›„, requirementsì— ìˆëŠ” ë‹¤ìˆ˜ì˜ module ì„¤ì¹˜ì—ì„œ ì—ëŸ¬ ë°œìƒ
  * í˜„ì¬ ì»´í“¨í„°ì—ëŠ” M1 pyenvê°€ ì„¤ì¹˜ë˜ì–´ ìˆìŒ
* í•´ê²°: X86ìš© pyenvë¡œ í™˜ê²½ì„¤ì •

---

### Solution
```bash
# iTerm ë³µì‚¬ í›„ iTerm-i386 ë§Œë“¦
# iTerm-386 ìš°í´ë¦­ - Get-Info - Open using Rosetta í´ë¦­

# iTerm-i386 ì—ì„œ x86 pyenv ì„¤ì¹˜
brew install pyenv

# pyenv ì…ë ¥ í›„ pyenv-virtualenv ì—†ì„ ì‹œ ë‹¤ìŒ ëª…ë ¹ì–´ ì…ë ¥
brew install --HEAD pyenv-virtualenv

# .zprofileì— ë‹¤ìŒ ë‚´ìš© ë„£ê¸°
eval "$(pyenv init --path)"

# .zshrcì— ë‹¤ìŒ ë‚´ìš© ë„£ê¸°
# pyenv (ARM & x86)
if [ $(arch) = "i386" ]; then
    eval "$(/usr/local/bin/brew shellenv)"
    alias brew86="arch -x86_64 /usr/local/bin/brew"
    alias pyenv86="arch -x86_64 pyenv"
    alias python3="/Users/zsupark/.pyenv-i386/shims/python3"
    export PYENV_ROOT=~/.pyenv-i386
    export LIBRARY_PATH=$LIBRARY_PATH:/usr/local/opt/openssl@1.1/lib/
else
    eval "$(/opt/homebrew/bin/brew shellenv)"
    export LIBRARY_PATH=$LIBRARY_PATH:/opt/homebrew/opt/openssl@1.1/lib/
fi

if command -v pyenv 1>/dev/null 2>&1; then
    if [ $(arch) = "i386" ]; then
        export PATH="$HOME/.pyenv-i386/bin:$PATH"
        eval "$(pyenv86 init -)"
        eval "$(pyenv86 virtualenv-init -)"
    else
        export PATH="$HOME/.pyenv/bin:$PATH"
        eval "$(pyenv init -)"
        eval "$(pyenv virtualenv-init -)"
    fi
fi

# ì ìš©
source ~/.zshrc

# python 3.8.5 ë‹¤ìš´
VERSION_ALIAS="3.8.5_x86" \
pyenv86 install -v 3.8.5

# clue-apiìš© ê°€ìƒí™˜ê²½ ìƒì„±
pyenv virtualenv 3.8.5 .clue-api

# requirementsì— í•„ìš”í•œ ëª¨ë“ˆ ì„¤ì¹˜
pip3 install wheel
brew86 install postgres

# clue-api requirements ì„¤ì¹˜
pip install -r requirements.txt
```
---

### ref 
* [ğŸ”— ARM & X86 Pyenv ì„¤ì¹˜](https://yosuniiiii.com/pyenv-on-multiple-architectures-arm-x86-64-with-pyinstaller-498b7e9a2eff)
* [ğŸ”— X86 Pyenv virtualenv-init ê´€ë ¨](https://github.com/pyenv/pyenv-virtualenv/issues/25)
